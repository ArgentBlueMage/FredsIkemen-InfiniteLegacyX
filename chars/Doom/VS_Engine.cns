;jump initiate
[statedef 40]
type    = s
physics = s
ctrl = 0

[state 40, 1]
type = velset
trigger1 = time = 0
y = 0

[state 40, 2]
type = changeanim
trigger1 = time = 0
value = 40

[state 40, 1]
type = velset
;trigger1 = time = 0
;trigger1 = command = "holdfwd"
trigger1 = prevstateno = 101
;trigger1 = sysvar(1) = 1
x = 7

[state 40, 1]
type = velset
trigger1 = time = 0
trigger1 = command = "holdback"
trigger1 = prevstateno = 105
x = -6

[state 40, 4]
type = varset
trigger1 = time = 0
sysvar(1) = 0

[state 40, 5]
type = varset
trigger1 = command = "holdfwd"
sysvar(1) = 1

[state 40, 6]
type = varset
trigger1 = command = "holdback"
sysvar(1) = -1

[state 40, 7]
type = velset
trigger1 = animtime = 0
trigger1 = var(3) = 0
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
y = const(velocity.jump.y)

[state 40, 8]
type = velset
trigger1 = animtime = 0
trigger1 = var(3) = 1
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, 3, -1.5))
y = -14

[state 40, 9]
type = velset
trigger1 = animtime = 0
trigger1 = prevstateno = 100
trigger1 = sysvar(1) = 1
x = const(velocity.runjump.fwd.x)

[state 40, 11]
type = varset
trigger1 = time = 0
var(3) = 0

[state 40, 12]
type = varset
trigger1 = command = "du"
trigger2 = command = "abc"
trigger3 = prevstateno = 420
trigger4 = prevstateno = 240
var(3) = 1

[state 50, playsnd]
type = playsnd
trigger1 = animtime = 0
trigger1 = var(3) = 1
value = s0,18

[State 100, 3]
type = PlaySnd
trigger1 = animtime = 0
trigger1 = var(3) = 1
value = 4000, 3
channel = 1

[state 40, 13]
type = varset
trigger1 = time = 0
var(12) = 0

[state 40, 14]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

; AirJump Start
[Statedef 45]
type    = A
physics = N
ctrl = 0
facep2 = 1
velset = 0,0
anim =41
sprpriority = 1

[State 45, air jump - finish]
type = VarSet
trigger1 = !Time
var(25) = 3


[State 45, 4]
type = VarSet
trigger1 = command = "holdfwd"
sysvar(1) = 1

[State 45, 5]
type = VarSet
trigger1 = command = "holdback"
sysvar(1) = -1

[State 45, 6]
type = VelSet
trigger1 = Time = 1
x = ifelse(sysvar(1)=0, const(velocity.airjump.neu.x), ifelse(sysvar(1)=1, const(velocity.airjump.fwd.x), const(velocity.airjump.back.x)))
y = -8

[State 0]
type = PlaySnd
trigger1 = time = 1
value = S4000,3
volumescale = 255

[state 100, 4]
type = explod
trigger1 = time = 1
id = 44
anim = 44
postype = p1
pos = 0,0
ownpal = 1
bindtime = 1
sprpriority = 5
persistent = 0
removeongethit = 1
scale = 0.5,0.8

[State 45, 7]
type = ChangeState
trigger1 = Time = 1
value = 46
ctrl = 1


;THIS IS IMPOURTANT, BUDDIES!
; landing anim
[statedef 46]
type    = a
movetype= a
physics = a
ctrl = 1 ;ifelse(var(3)=1,1,0)
facep2 = 1

[state hee]
type = changeanim
triggerall = time <1
triggerall = Anim != 41
trigger1 = Vel X = 0
trigger1 = Vel Y < 0
value = 41

[state hee]
type = changeanim
triggerall = time <1
triggerall = Anim != 42
triggerall = Vel X > 0
trigger1 = Vel Y = 0
trigger2 = Vel Y != 0
value = 42

[state hee]
type = changeanim
triggerall = time <1
triggerall = Anim != 43
triggerall = Vel X < 0
trigger1 = Vel Y = 0
trigger2 = Vel Y != 0
value = 43

[state 710,5]
type = screenbound
trigger1 = p2stateno = [715,717]
trigger2 = p2stateno = 328
value = 0
movecamera = 0,0

[state 460, 7]
type = veladd
trigger1 = var(3) = 1
trigger1 = command = "holdback"
trigger1 = vel x > -1.5
x = -.15


[state 460, 8]
type = veladd
trigger1 = var(3) = 1
trigger1 = command = "holdfwd"
trigger1 = vel x < 3
x = .15

[state 460, 9]
type = veladd
trigger1 = var(3) = 1
y = -0.14


[state 460, 1]
type = turn
trigger1 = p2dist x < 0
trigger1 = var(3) = 1
;---------------------------------------------------------
; jump Up
[statedef 50]
type    = a
physics = a


[state 50, 1]
type = varset
trigger1 = time = 0
sysvar(1) = 0

[state 50, 2]
type = changeanim
trigger1 = time = 0
trigger1 = var(3) = 0
value = ifelse((vel x)=0, 41, ifelse((vel x)>0, 42, 43))

[state 50, 3]
type = changeanim
trigger1 = time = 0
trigger1 = var(3) = 1
value = ifelse((vel x)=0, 50, ifelse((vel x)>0, 51, 52))

[state 50, 4]
type = varset
triggerall = time = 0
trigger1 = vel x = 0
var(1) = 0

[state 50, 5]
type = varset
triggerall = time = 0
trigger1 = vel x > 0
trigger2 = vel x < 0
var(1) = 1

[state 50, 6]
type = turn
trigger1 = p2dist x < 0
trigger1 = var(3) = 1

[state 50, 7]
type = veladd
trigger1 = var(3) = 1
trigger1 = command = "holdback"
trigger1 = vel x > -1.5
x = -.05

[state 50, 8]
type = veladd
trigger1 = var(3) = 1
trigger1 = command = "holdfwd"
trigger1 = vel x < 3
x = .15



[state 50, 9]
type = veladd
trigger1 = var(3) = 1
y = -0.14


[state 50,5]
type = explod
trigger1 = time = 1
trigger1 = var(3) = 1
trigger1 = prevstateno != 45
anim = 6010
id = 6010
postype = p1
pos = 0,40
ownpal = 1
bindtime = 1
sprpriority = 5
persistent = 0
removeongethit = 0

[State ]
type = removeExplod
trigger1= time = 0
id = 8889



[State 40, Super Jump Up Sparks]
type = Explod
anim = 8035
ID = 8035
trigger1 = time = 1
trigger1 = anim = 50
postype = P1
pos = -2,-8
ownpal = 1
bindtime = -1
removeongethit = 1
sprpriority = 5

[State 40, Super Jump Up Sparks]
type = Explod
anim = 8036
ID = 8036
trigger1 = time = 1
trigger1 = anim = 51
postype = P1
pos = -2,-8
ownpal = 1
bindtime = -1
removeongethit = 1
sprpriority = 5

[State 40, Super Jump Up Sparks]
type = Explod
anim = 8037
ID = 8037
trigger1 = time = 1
trigger1 = anim = 52
postype = P1
pos = -2,-8
ownpal = 1
bindtime = -1
removeongethit = 1
sprpriority = 5


[state 50, 12]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > 0
value = 52

;---------------------------------------------------------
; jump land
[statedef 52]
type    = s
physics = s
facep2 = 1
velset = 0,0
ctrl = 0

[State 750, Dust]
type = removeExplod
trigger1 = time= 0
id =8888

[State 750, Dust]
type = removeExplod
trigger1 = time= 0
id =8889


[State 0]
type = PlaySnd
trigger1 = time = 1
value = S4000,15
volumescale = 255


[state 52, 1]
type = changeanim
trigger1 = time = 0
value = 47

[state 52, Dust]
type = explod
trigger1 = time = 0
anim = 6011
id = 6007
postype = p1
pos = 0,0
ownpal = 1
bindtime = 1
sprpriority = -2
persistent = 0
removeongethit = 0

[state 52, 3]
type = posset
trigger1 = time = 0
y = 0

[state 52, 4]
type = ctrlset
trigger1 = time = 1
value = 1

[state 52, 5]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;Wall Cling
[Statedef 60]
type = A
movetype = I
physics = N
velset = 0,0
anim = 60
ctrl =0

[State 1332, PlaySnd]
type = PlaySnd
trigger1 = Time = 0
value = 800,1

[State 1400, VelSet]
type = VelSet
trigger1 = command != "holdfwd"
x = 0
y = 0

[State 1400, PosAdd]
type = PosAdd
trigger1 = 1
x = -1*(backedgebodydist)

[State 1400, StateTypeSet]
type = StateTypeSet
trigger1 =  vel x != 0
statetype = A       ;S,A,C,L
movetype = I        ;I,A,H
physics = A         ;A,C,S,N

[State 1400, EndState]
type = ChangeState
trigger1 = animtime = 0
value = 61

;---------
;Wall Cling Release
[Statedef 61]
type = A
movetype = I
physics = A
velset = 7,-7
anim = 61
ctrl = 1

[State 1401, EndState]
type = ChangeState
trigger1 = animtime = 0
value = 460
ctrl = 1

;guard push
[statedef 171]
type    = s
movetype= i
physics = s
poweradd= 0
velset = 10,0
ctrl = 0
anim = 171
sprpriority = 2

[state 160, velset]
type = velset
trigger1 = time = 1
x = -10

[state 160, width]
type = width
trigger1 = 1
value = 10,0

;
[state 160, nothitby]
type = nothitby
trigger1 = 1
value = sca
time = 1

[state 1010,1]
type = playsnd
trigger1 = time = 2
value = s5546,0
volumescale = 255

[state guard push helper]
type = helper
trigger1 = time = 0
helpertype = normal
name = "guardpush"
postype = p1
pos = -50,0
stateno = 174
ownpal = 1
size.height = 200
size.ground.back = 30
size.ground.front = 30

[state Guard Push Explod]
type = explod
trigger1 = time = 5
anim = 9102
pos = 60, -80
postype = p1
removetime = -2
ignorehitpause = 1
bindtime = 5
persistent = 0
sprpriority = 4
ownpal = 1

[state 160, changestate]
type = changestate
trigger1 = time = 20
value = 150

;Guard push crouch
[statedef 172]
type    = c
movetype= i
physics = s
poweradd= 0
velset = 10,0
ctrl = 0
anim = 172
sprpriority = 2


[state 161, velset]
type = velset
trigger1 = time = 1
x = -10

[state 161, width]
type = width
trigger1 = 1
value = 10,0

[state 160, nothitby]
type = nothitby
trigger1 = 1
value = sca
time = 1


[state 161, guard push helper]
type = helper
trigger1 = time = 0
helpertype = normal
name = "guardpush"
postype = p1
pos = -50,0
stateno = 174
ownpal = 1
size.height = 200
size.ground.back = 30
size.ground.front = 30

[state 1010,1]
type = explod
trigger1 = time = 2
anim = 9102
pos = 60, -60
postype = p1
removetime = -2
ignorehitpause = 1
bindtime = 5
persistent = 0
sprpriority = 4
ownpal = 1

[state 1010,1]
type = playsnd
trigger1 = time = 2
value = s5546,0
volumescale = 255

[state 161, changestate]
type = changestate
trigger1 = time = 20
value = 151

;Guard push air
[statedef 173]
type    = a
movetype= i
physics = s
poweradd= 0
velset = 10,0
ctrl = 0
anim = 173
sprpriority = 2
facep2 = 1


[state 162, velset]
type = velset
trigger1 = time = 1
x = -10

[state 162, width]
type = width
trigger1 = 1
value = 10,0

[state 160, nothitby]
type = nothitby
trigger1 = 1
value = sca
time = 1


[state 162, guard push helper]
type = helper
trigger1 = time = 0
helpertype = normal
name = "guardpush"
postype = p1
pos = -50,0
stateno = 174
ownpal = 1
size.height = 200
size.ground.back = 30
size.ground.front = 30

[state 1010,1]
type = explod
trigger1 = time = 5
anim = 9102
pos = 60, -102
postype = p1
removetime = -2
ignorehitpause = 1
bindtime = 5
persistent = 0
sprpriority = 4
ownpal = 1

[state 1010,1]
type = playsnd
trigger1 = time = 2
value = s5546,0
volumescale = 255

[state 162, changestate]
type = changestate
trigger1 = time = 20
value = 155

; guard push (helper)
[statedef 174]
type    = s
movetype= i
physics = n
poweradd= 0
ctrl = 0
anim = 174
sprpriority = -4

[state 163, playerpush]
type = posset
trigger1 = time = 0
y = 100


[state 163, playerpush]
type = playerpush
trigger1 = time >= 0
value = 1

[state 163, velset 1]
type = velset
trigger1 = time = [0,10]
x = 30

[state 163, velset 2]
type = velset
trigger1 = time = [11,13]
x = 20

[state 163, velset 2]
type = velset
trigger1 = time >= 14
x = 10

[state 163, nothitby]
type = nothitby
trigger1 = 1
value = sca
time = 1

[state 163, Destroyself]
type = Destroyself
trigger1 = animtime = 0


; landing anim
[statedef 460]
type    = a
movetype= i
physics = a
ctrl = 1 ;ifelse(var(3)=1,1,0)
facep2 = 1


[State 191, Wood 1]
type = removeExplod
trigger1 = AnimElem = 1
ID= 12

[state hee]
type = changeanim
trigger1 = time = 0
value = 460


[state 710,5]
type = screenbound
trigger1 = p2stateno = [715,717]
trigger2 = p2stateno = 328
value = 0
movecamera = 0,0

[state 460, 7]
type = veladd
trigger1 = var(3) = 1
trigger1 = command = "holdback"
trigger1 = vel x > -1.5
x = -.15

[state 460, 8]
type = veladd
trigger1 = var(3) = 1
trigger1 = command = "holdfwd"
trigger1 = vel x < 3
x = .15

[state 460, 9]
type = veladd
trigger1 = var(3) = 1
y = -0.14


[state 460, 1]
type = turn
trigger1 = p2dist x < 0
trigger1 = var(3) = 1


;Foward Recovery Roll
[Statedef 891]
type    = C
movetype= I
physics = N
juggle  = 0
poweradd= 0
velset = 12,0
ctrl = 0
anim = 5120
sprpriority = 5


[State 100, 3]
type = PlaySnd
trigger1 = time = 1
value = 4000, 3
channel = 1


[State 890, 1]
type = PlayerPush
trigger1 = Time >= 0
value = 0


[State 890, 3]
type = PosSet
trigger1 = Time >= 0
y = 0

[State 890, 5]
type = NotHitBy
trigger1 = Time = 0
value = SCA
time = 32

[State 895, 6]
type = ChangeState
trigger1 =time = 15
value = 0
ctrl = 1

[State 890, Dead]
type = ChangeState
trigger1 = alive = 0
value = 5150
ctrl = 0

;---------------------------------------------------------------------------
;Backward Recovery Roll
[Statedef 895]
type    = C
movetype= I
physics = N
juggle  = 0
poweradd= 0
velset = -12,0
ctrl = 0
anim = 5120
sprpriority = 5


[State 100, 3]
type = PlaySnd
trigger1 = time = 1
value = 4000, 3
channel = 1

[State 895, 1]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 895, 3]
type = PosSet
trigger1 = Time >= 0
y = 0


[State 895, 5]
type = NotHitBy
trigger1 = Time = 0
value = SCA
time = 32

[State 895, 6]
type = ChangeState
trigger1 =time = 15
value = 0
ctrl = 1

[State 895, Dead]
type = ChangeState
trigger1 = alive = 0
value = 5150
ctrl = 0

;Finish normal
[Statedef 9070]
type = A
movetype = I
physics = N
anim = 9999

[State ] 
type = PlaySnd
trigger1 = time = 1
value = S8700,0
persistent = 0
volumescale = 255

[State ] 
type = Explod
trigger1 = time = 0
anim = 4303
bindtime = -1
pos = 160,120
postype = back
ownpal = 1
persistent = 0
sprpriority = -5
ignorehitpause = 1
pausemovetime = 999

[State ]
type = DestroySelf
trigger1 = parent,statetype !=A  && time > 120 && root,movetype=I
trigger2= roundstate<3

;Hyper Finish 01
[Statedef 9071]
type = A
movetype = I
physics = N
anim = 9999


[State ] 
type = PlaySnd
trigger1 = time = 2
value = S8700,2
persistent = 0
volumescale = 255

[State ] 
type = PlaySnd
trigger1 = time = 10
value = S230,11
persistent = 0
volumescale = 255

[State ] 
type = Explod
trigger1 = time = 0
anim = 4303
bindtime = -1
pos = 160,120
postype = back
ownpal = 1
persistent = 0
sprpriority = -5
ignorehitpause = 1
pausemovetime = 999

[State ] 
type = Explod
trigger1 = time = 0
anim = 9131
id = 16550
bindtime = -1
pos = 160,120
postype = back
ownpal = 1
persistent = 0
supermovetime = 999999999999999999999 
pausemovetime = 999999999999999999999
sprpriority = -5
ignorehitpause = 1
removetime = -1

[State -2]
type = explod
trigger1 = time = 0
anim = 16550
id = 16550
pos = -15,65
postype = left
removetime = -1
sprpriority = 5
ontop = 1
bindtime = -1
ignorehitpause = 0
ownpal = 1
persistent = 0
supermovetime = 999999999999999999999 
pausemovetime = 999999999999999999999

[State 0]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = nobg
flag3 = nofg;nokosnd
ignorehitpause = 1
persistent = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobardisplay

[State -2]
type = removeexplod
trigger1 = parent,statetype !=A  && time > 160
trigger2= roundstate<3
trigger3 = parent,stateno = [180,189]
id = 16550

[State 0, DestroySelf]
type = DestroySelf
trigger1 = parent,statetype !=A  && time > 160
trigger2= roundstate<3
trigger3 = parent,stateno = [180,189]

;Hyper Finish 02
[Statedef 9072]
type = A
movetype = I
physics = N
anim = 9999


[State ] 
type = PlaySnd
trigger1 = time = 2
value = S8700,2
persistent = 0
volumescale = 255

[State ] 
type = PlaySnd
trigger1 = time = 10
value = S230,11
persistent = 0
volumescale = 255

[State ] 
type = Explod
trigger1 = time = 0
anim = 4303
bindtime = -1
pos = 160,120
postype = back
ownpal = 1
persistent = 0
sprpriority = -5
ignorehitpause = 1
pausemovetime = 999

[State ] 
type = Explod
trigger1 = time = 0
anim = 9131
id = 16550
bindtime = -1
pos = 160,120
postype = back
ownpal = 1
persistent = 0
supermovetime = 999999999999999999999 
pausemovetime = 999999999999999999999
sprpriority = -5
ignorehitpause = 1
removetime = -1

[State -2]
type = explod
trigger1 = time = 0
anim = 16551
id = 16550
pos =-15,65
postype = left
removetime = -1
sprpriority = 5
ontop = 1
bindtime = -1
ignorehitpause = 0
ownpal = 1
persistent = 0
supermovetime = 999999999999999999999 
pausemovetime = 999999999999999999999

[State 0]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = nobg
flag3 = nofg;nokosnd
ignorehitpause = 1
persistent = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobardisplay

[State -2]
type = removeexplod
trigger1 = parent,statetype !=A  && time > 160
trigger2= roundstate<3
trigger3 = parent,stateno = [180,189]
id = 16550

[State 0, DestroySelf]
type = DestroySelf
trigger1 = parent,statetype !=A  && time > 160
trigger2= roundstate<3
trigger3 = parent,stateno = [180,189]

;Hyper Finish 03
[Statedef 9073]
type = A
movetype = I
physics = N
anim = 9999


[State ] 
type = PlaySnd
trigger1 = time = 2
value = S8700,2
persistent = 0
volumescale = 255

[State ] 
type = PlaySnd
trigger1 = time = 10
value = S230,11
persistent = 0
volumescale = 255

[State ] 
type = Explod
trigger1 = time = 0
anim = 4303
bindtime = -1
pos = 160,120
postype = back
ownpal = 1
persistent = 0
sprpriority = -5
ignorehitpause = 1
pausemovetime = 999

[State ] 
type = Explod
trigger1 = time = 0
anim = 9131
id = 16550
bindtime = -1
pos = 160,120
postype = back
ownpal = 1
persistent = 0
supermovetime = 999999999999999999999 
pausemovetime = 999999999999999999999
sprpriority = -5
ignorehitpause = 1
removetime = -1

[State -2]
type = explod
trigger1 = time = 0
anim = 16552
id = 16550
pos = -15,65
postype = left
removetime = -1
sprpriority = 5
ontop = 1
bindtime = -1
ignorehitpause = 0
ownpal = 1
persistent = 0
supermovetime = 999999999999999999999 
pausemovetime = 999999999999999999999

[State 0]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = nobg
flag3 = nofg;nokosnd
ignorehitpause = 1
persistent = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobardisplay

[State -2]
type = removeexplod
trigger1 = parent,statetype !=A  && time > 160
trigger2= roundstate<3
trigger3 = parent,stateno = [180,189]
id = 16550

[State 0, DestroySelf]
type = DestroySelf
trigger1 = parent,statetype !=A  && time > 160
trigger2= roundstate<3
trigger3 = parent,stateno = [180,189]



;Hyper Finish 04
[Statedef 9074]
type = A
movetype = I
physics = N
anim = 9999


[State ] 
type = PlaySnd
trigger1 = time = 2
value = S8700,2
persistent = 0
volumescale = 255

[State ] 
type = PlaySnd
trigger1 = time = 10
value = S230,11
persistent = 0
volumescale = 255

[State ] 
type = Explod
trigger1 = time = 0
anim = 4303
bindtime = -1
pos = 160,120
postype = back
ownpal = 1
persistent = 0
sprpriority = -5
ignorehitpause = 1
pausemovetime = 999

[State ] 
type = Explod
trigger1 = time = 0
anim = 9131
id = 16550
bindtime = -1
pos = 160,120
postype = back
ownpal = 1
persistent = 0
supermovetime = 999999999999999999999 
pausemovetime = 999999999999999999999
sprpriority = -5
ignorehitpause = 1
removetime = -1

[State -2]
type = explod
trigger1 = time = 0
anim = 16553
id = 16550
pos = -15,65
postype = left
removetime = -1
sprpriority = 5
ontop = 1
bindtime = -1
ignorehitpause = 0
ownpal = 1
persistent = 0
supermovetime = 999999999999999999999 
pausemovetime = 999999999999999999999

[State 0]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = nobg
flag3 = nofg;nokosnd
ignorehitpause = 1
persistent = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobardisplay

[State -2]
type = removeexplod
trigger1 = parent,statetype !=A  && time > 160
trigger2= roundstate<3
trigger3 = parent,stateno = [180,189]
id = 16550

[State 0, DestroySelf]
type = DestroySelf
trigger1 = parent,statetype !=A  && time > 160
trigger2= roundstate<3
trigger3 = parent,stateno = [180,189]


;====================================
[Statedef 7000]
type    = a
movetype= a
physics = N
velset = 0,0
anim = 4700
ctrl = 0
poweradd = -1000

[State 4512, invincibility]
type = varset
trigger1 = 1
v = 52
value = 0

[state haha]
type = pause
trigger1 = time = 1
time = 48
movetime = 20
pausebg = 0
ignorehitpause = 1

[State 4512, invincibility]
type = nothitby
trigger1 = 1
value = sca
time = 3

[state 3107, 2]
type = playsnd
trigger1 = time = 0
value = 1,20
channel = 0

[state 4002, 1]
type = explod
trigger1 = time = 1
trigger1 = numexplod(7003) = 0
anim = 7000
id = 7000
postype = back
pos = 0, 0
sprpriority = -3
ownpal = 1
bindtime = -1
supermove = 1
pausemovetime = 9999

[state 4002, 3.2]
type = explod
trigger1 = time = 1
trigger1 = partner,var(55) = 0
anim = F1001
id = 9003
postype = back
pos = 0, 0
sprpriority = -4
ownpal = 1
bindtime = -1
supermovetime = 99999
pausemovetime = 99999
persistent = 0

[state 4002, 3.2]
type = explod
trigger1 = time = 1
trigger1 = partner,var(55) = 1
anim = F1002
id = 9003
postype = back
pos = 0, 0
sprpriority = -4
ownpal = 1
bindtime = -1
supermovetime = 99999
pausemovetime = 99999
persistent = 0

[state 2000, 4]
type = helper
trigger1 = time = 1
trigger1 = partner,var(55) = 0
trigger1 = numhelper(9002) = 0
stateno = 9004
id = 9002
name = "floor"
pos = 0,0
postype = p1
bindtime = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[state 2000, 4]
type = helper
trigger1 = time = 1
trigger1 = partner,var(55) = 1
trigger1 = numhelper(9002) = 0
stateno = 9003
id = 9002
name = "floor"
pos = 0,0
postype = p1
bindtime = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[State 4500, playsnd] 
type = playsnd
trigger1 = time = 0
abspan = 0
value = F4,0

[State 4500, playsnd] 
type = playsnd
trigger1 = time = 0
value = F4,2
volume = 255

;[State 4500, screen bound] ; Prevents the camera from following the char
;type = changeanim
;trigger1 = time = 0
;value = 41

[State 4500, screen bound] ; Prevents the camera from following the char
type = ScreenBound
trigger1 = 1
value = 0

[State 4500, position]
type = Posset
trigger1 = time = 0
trigger1 = facing = 1
x = (partner, pos x) - 257
y = ifelse(var(31) > 0,-730,-130)

[State 4500, position]
type = Posset
trigger1 = time = 0
trigger1 = facing = -1
x = (partner, pos x) + 257
y = ifelse(var(31) > 0,-730,-130)

[State 4500, position]
type = Posadd
trigger1 = 1
x = 16

[State 4500, velocity]
type = VelSet
trigger1 = time = 0
y = 3

[State 4500, velocity]
type = Veladd
trigger1 = 1
y = .7

; Tag attack LV1
[State 4501, LV1]
type = ChangeState
trigger1 = time > 7
trigger1 = pos y >= ifelse(var(31) > 0,-600,-0)
value = 7001

;---------------------------------------------------------------------------
;retsuzan
[statedef 7001]
type    = s
movetype= a
physics = n
velset = 0,0
anim = 4000
facep2 = 1
ctrl = 0

[State 4512, invincibility]
type = changestate
trigger1 = partner,stateno=[7000,7401];||partner,stateno=7100||partner,stateno=7200||partner,stateno=7300||partner,stateno=70400
value = 7600+(statetype=A)
ignorehitpause = 1

[state 3000, 2]
type = afterimage
trigger1 = partner,var(55) = 0
trigger1 = time = 0
time = 99999999
length = 40
framegap = 6
palcolor = 0  
palinvertall = 0
palbright = 0, 0, 0
palcontrast = 0, 255, 160

[state 3000, 2]
type = afterimage
trigger1 = partner,var(55) = 1
trigger1 = time = 0
time = 99999999
length = 40
framegap = 6
palcolor = 0  
palinvertall = 0
palbright = 0, 0, 0
palcontrast = 255, 40,40

[State 4512, invincibility]
type = varset
trigger1 = time > 0
v = 55
value = 1

[state hehe]
type = posset
trigger1 = time = 0
y = ifelse(var(31) > 0,-600,-0)


[state 810, grab sound]
type = velset
trigger1 = time = 62
x = 0

[state 810, grab sound]
type = velset
trigger1 = time = 4
x = 8

[state 810, grab sound]
type = playsnd
trigger1 = animelem = 2
value = 1300,0
channel = 0

[state 810, grab sound]
type = playsnd
trigger1 = animelem = 2
value = 1200,2

;stars------------------------------------------------------------------------------
[state 810, grab sound]
type = explod
trigger1 = time = 6
trigger2 = time = 20
trigger3 = time = 36
trigger4 = time = 48
trigger5 = time = 62
anim = 1215
bindtime = 1
scale = .5,.5
pos = -30,-7
sprpriority = 3

[state 810, grab sound]
type = explod
trigger1 = time = 7
trigger2 = time = 21
trigger3 = time = 37
trigger4 = time = 49
trigger5 = time = 63
anim = 1215
bindtime = 1
scale = .5,.5
pos = -56,-20
sprpriority = 3

[state 810, grab sound]
type = explod
trigger1 = time = 8
trigger2 = time = 22
trigger3 = time = 38
trigger4 = time = 50
trigger5 = time = 64
anim = 1215
bindtime = 1
scale = .5,.5
pos = -62,-50
sprpriority = 3

[state 810, grab sound]
type = explod
trigger1 = time = 9
trigger2 = time = 23
trigger3 = time = 39
trigger4 = time = 51
trigger5 = time = 65
anim = 1215
bindtime = 1
scale = .5,.5
pos = -60,-77
sprpriority = 3

[state 810, grab sound]
type = explod
trigger1 = time = 10
trigger2 = time = 24
trigger3 = time = 40
trigger4 = time = 52
trigger5 = time = 66
anim = 1215
bindtime = 1
scale = .5,.5
pos = -49,-98
sprpriority = 3

[state 810, grab sound]
type = explod
trigger1 = time = 11
trigger2 = time = 25
trigger3 = time = 41
trigger4 = time = 53
trigger5 = time = 67
anim = 1215
bindtime = 1
scale = .5,.5
pos = -22,-117
sprpriority = 3

[state 810, grab sound]
type = explod
trigger1 = time = 12
trigger2 = time = 26
trigger3 = time = 42
trigger4 = time = 54
trigger5 = time = 68
anim = 1215
bindtime = 1
scale = .5,.5
pos = 14,-114
sprpriority = 3

[state 810, grab sound]
type = explod
trigger1 = time = 13
trigger2 = time = 27
trigger3 = time = 43
trigger4 = time = 55
trigger5 = time = 69
anim = 1215
bindtime = 1
scale = .5,.5
pos = 42,-101

[state 810, grab sound]
type = explod
trigger1 = time = 14
trigger2 = time = 28
trigger3 = time = 44
trigger4 = time = 56
trigger5 = time = 70
anim = 1215
bindtime = 1
scale = .5,.5
pos = 73,-73
sprpriority = 3

[state 810, grab sound]
type = explod
trigger1 = time = 15
trigger2 = time = 29
trigger3 = time = 45
trigger4 = time = 57
trigger5 = time = 71
anim = 1215
bindtime = 1
scale = .5,.5
pos = 81,-42
sprpriority = 3

[state 810, grab sound]
type = explod
trigger1 = time = 16
trigger2 = time = 30
trigger3 = time = 46
trigger4 = time = 58
trigger5 = time = 72
anim = 1215
bindtime = 1
scale = .5,.5
pos = 71,-4
sprpriority = 3
;======================================================================


[state 210, 2]
type = hitdef
trigger1 = time%2 = 0
trigger1 = time < 66
attr = s, sa
animtype  = hard
fall.animtype = hard
damage    = 20,10
hitflag = MAFD
guarDFlag = MA
pausetime = 4,4
sparkno = 6+var(30)
guard.sparkno = 0
sparkxy = -10,-50
hitsound = -1;+var(49),5
guardsound = 0+var(49),8
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -10,0
air.velocity = -8,-6
air.hittime = 25

[state 210, 2]
type = hitdef
trigger1 = time%2 = 0
trigger1 = time > 66
attr = s, sa
animtype  = hard
fall.animtype = hard
damage    = 20,10
hitflag = MAFD
guarDFlag = MA
pausetime = 4,4
sparkno = 6+var(30)
guard.sparkno = 0
sparkxy = -10,-50
hitsound = -1;+var(49),5
guardsound = 0+var(49),8
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -13,-11
air.velocity = -13,-11
air.hittime = 25
fall = 1
fall.recover = 0

[state 0, ]
type = envcolor
trigger1 = movehit
value = 255,255,255
time = 1
under = 0
ignorehitpause = 1

[state hah]
type = playsnd
trigger1 = movehit
value = F0+var(49),5
channel = 3
ignorehitpause = 1

[state hah]
type = movehitreset
trigger1 = movecontact
ignorehitpause = 1

[state 0, ]
type = envcolor
trigger1 = movehit
value = 255,255,255
time = 1
under = 0
ignorehitpause = 1
persistent = 0

[state 810, grab sound]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;====================================
[Statedef 7100]
type    = a
movetype= a
physics = N
velset = 0,0
anim = 4700
ctrl = 0
poweradd = -1000

[State 4512, invincibility]
type = varset
trigger1 = 1
v = 52
value = 0

[state haha]
type = pause
trigger1 = time = 1
time = 48
movetime = 20
pausebg = 0
ignorehitpause = 1

[State 4512, invincibility]
type = nothitby
trigger1 = 1
value = sca
time = 3

[state 3107, 2]
type = playsnd
trigger1 = time = 0
value = 1,20
channel = 0

[state 4002, 1]
type = explod
trigger1 = time = 1
trigger1 = numexplod(7003) = 0
anim = 7000
id = 7000
postype = back
pos = 0, 0
sprpriority = -3
ownpal = 1
bindtime = -1
supermove = 1
pausemovetime = 9999

[state 4002, 3.2]
type = explod
trigger1 = time = 1
trigger1 = partner,var(55) = 0
anim = F1001
id = 9003
postype = back
pos = 0, 0
sprpriority = -4
ownpal = 1
bindtime = -1
supermovetime = 99999
pausemovetime = 99999
persistent = 0

[state 4002, 3.2]
type = explod
trigger1 = time = 1
trigger1 = partner,var(55) = 1
anim = F1002
id = 9003
postype = back
pos = 0, 0
sprpriority = -4
ownpal = 1
bindtime = -1
supermovetime = 99999
pausemovetime = 99999
persistent = 0

[state 2000, 4]
type = helper
trigger1 = time = 1
trigger1 = partner,var(55) = 0
trigger1 = numhelper(9002) = 0
stateno = 9004
id = 9002
name = "floor"
pos = 0,0
postype = p1
bindtime = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[state 2000, 4]
type = helper
trigger1 = time = 1
trigger1 = partner,var(55) = 1
trigger1 = numhelper(9002) = 0
stateno = 9003
id = 9002
name = "floor"
pos = 0,0
postype = p1
bindtime = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[State 4500, playsnd] 
type = playsnd
trigger1 = time = 0
abspan = 0
value = F4,0

[State 4500, playsnd] 
type = playsnd
trigger1 = time = 0
value = F4,2
volume = 255

;[State 4500, screen bound] ; Prevents the camera from following the char
;type = changeanim
;trigger1 = time = 0
;value = 41

[State 4500, screen bound] ; Prevents the camera from following the char
type = ScreenBound
trigger1 = 1
value = 0

[State 4500, position]
type = Posset
trigger1 = time = 0
trigger1 = facing = 1
x = (partner, pos x) - 257
y = ifelse(var(31) > 0,-730,-130)

[State 4500, position]
type = Posset
trigger1 = time = 0
trigger1 = facing = -1
x = (partner, pos x) + 257
y = ifelse(var(31) > 0,-730,-130)

[State 4500, position]
type = Posadd
trigger1 = 1
x = 16

[State 4500, velocity]
type = VelSet
trigger1 = time = 0
y = 3

[State 4500, velocity]
type = Veladd
trigger1 = 1
y = .7

; Tag attack LV1
[State 4501, LV1]
type = ChangeState
trigger1 = time > 7
trigger1 = pos y >= ifelse(var(31) > 0,-600,-0)
value = 7101

;======================================================
; kououken!
[statedef 7101]
type    = s
movetype= a
physics = n
anim = 4100
facep2 = 1
velset = 0,0
ctrl = 0

[State 4512, invincibility]
type = varset
trigger1 = time < 6
v = 52
value = 0

[State 4512, invincibility]
type = changestate
trigger1 = partner,stateno=[7000,7401];||partner,stateno=7100||partner,stateno=7200||partner,stateno=7300||partner,stateno=70400
value = 7600+(statetype=A)
ignorehitpause = 1

[state 3000, 2]
type = afterimage
trigger1 = partner,var(55) = 0
trigger1 = time = 0
time = 99999999
length = 40
framegap = 6
palcolor = 0  
palinvertall = 0
palbright = 0, 0, 0
palcontrast = 0, 255, 160

[state 3000, 2]
type = afterimage
trigger1 = partner,var(55) = 1
trigger1 = time = 0
time = 99999999
length = 40
framegap = 6
palcolor = 0  
palinvertall = 0
palbright = 0, 0, 0
palcontrast = 255, 40,40

[State 4512, invincibility]
type = varset
trigger1 = 1
v = 55
value = 1

[state hehe]
type = posset
trigger1 = time = 0
y = ifelse(var(31) > 0,-600,-0)

; no star Field
[state -2, 1]
type = statetypeset
trigger1 = animelem = 4
value = A

; no star Field
[state -2, 1]
type = velset
trigger1 = animelem = 4
x = 5
y = -4

[state -2, 1]
type = playsnd
trigger1 = animelem = 4
value = S3200,0
channel = 0

[state -2, 1]
type = playsnd
trigger1 = animelem = 13
value = S1100,0
channel = 0

[state 235, 4]
type = hitdef
trigger1 = animelem = 4
trigger2 = animelem = 5
trigger3 = animelem = 6
attr = s, ha
damage    = 20,15
getpower  = 0
givepower = 15
guarDFlag = ma
animtype = Hard
pausetime = 5,6
sparkno = 6+var(30)
guard.sparkno = 0
sparkxy = -15,-85
hitsound = -1
guardsound = -1
ground.animtype = Up
ground.slidetime = 12
ground.hittime  = 1
ground.velocity = -0,-14
air.animtype = Up
air.velocity = -3,-11
airguard.velocity = -4
fall = 1
p2stateno = 6110

[state 235, 4]
type = hitdef
trigger1 = animelem = 13
trigger2 = animelem = 14
trigger3 = animelem = 15
attr = s, ha
damage    = 20,15
getpower  = 0
givepower = 15
guarDFlag = ma
animtype = Hard
pausetime = 5,6
sparkno = 6+var(30)
guard.sparkno = 0
sparkxy = -15,-85
hitsound = -1
guardsound = -1
ground.animtype = Up
ground.slidetime = 12
ground.hittime  = 1
ground.velocity = -5,-17
air.animtype = Up
air.velocity = -5,-11
airguard.velocity = -4
fall = 1
p2stateno = 6110

[state 0, ]
type = envcolor
trigger1 = movehit
value = 255,255,255
time = 1
under = 0
ignorehitpause = 1

[state 0, ]
type = playsnd
trigger1 = movehit
value = F0+var(49),5
channel = 3
ignorehitpause = 1

[state 0, ]
type = playsnd
trigger1 = moveguarded
value = F0+var(49),5
channel = 3
ignorehitpause = 1

[state 3000, 2]
type = afterimage
trigger1 = animelem = 3
time = 99999999
length = 40
framegap = 6
palcolor = 0  
palinvertall = 0
palbright = 0, 0, 0
palcontrast = 100, 100, 255

[state haha]
type = movehitreset
trigger1 = movecontact
ignorehitpause = 1

[state 4014, 25]
type = veladd
trigger1 = time > 30
y = .7

[state haha]
type = changestate
trigger1 = pos y >= ifelse(var(31) > 0,-600,0)
trigger1 = time > 30
value = 4101
;====================================
[Statedef 7200]
type    = a
movetype= a
physics = N
velset = 0,0
anim = 4700
ctrl = 0
poweradd = -1000

[State 4512, invincibility]
type = varset
trigger1 = 1
v = 52
value = 0

[state haha]
type = pause
trigger1 = time = 1
time = 48
movetime = 17
pausebg = 0
ignorehitpause = 1

[State 4512, invincibility]
type = nothitby
trigger1 = 1
value = sca
time = 3

[state 3107, 2]
type = playsnd
trigger1 = time = 0
value = 1,20
channel = 0

[state 4002, 1]
type = explod
trigger1 = time = 1
trigger1 = numexplod(7003) = 0
anim = 7000
id = 7000
postype = back
pos = 0, 0
sprpriority = -3
ownpal = 1
bindtime = -1
supermove = 1
pausemovetime = 9999

[state 4002, 3.2]
type = explod
trigger1 = time = 1
trigger1 = partner,var(55) = 0
anim = F1001
id = 9003
postype = back
pos = 0, 0
sprpriority = -4
ownpal = 1
bindtime = -1
supermovetime = 99999
pausemovetime = 99999
persistent = 0

[state 4002, 3.2]
type = explod
trigger1 = time = 1
trigger1 = partner,var(55) = 1
anim = F1002
id = 9003
postype = back
pos = 0, 0
sprpriority = -4
ownpal = 1
bindtime = -1
supermovetime = 99999
pausemovetime = 99999
persistent = 0

[state 2000, 4]
type = helper
trigger1 = time = 1
trigger1 = partner,var(55) = 0
trigger1 = numhelper(9002) = 0
stateno = 9004
id = 9002
name = "floor"
pos = 0,0
postype = p1
bindtime = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[state 2000, 4]
type = helper
trigger1 = time = 1
trigger1 = partner,var(55) = 1
trigger1 = numhelper(9002) = 0
stateno = 9003
id = 9002
name = "floor"
pos = 0,0
postype = p1
bindtime = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[State 4500, playsnd] 
type = playsnd
trigger1 = time = 0
abspan = 0
value = F4,0

[State 4500, playsnd] 
type = playsnd
trigger1 = time = 0
value = F4,2
volume = 255

;[State 4500, screen bound] ; Prevents the camera from following the char
;type = changeanim
;trigger1 = time = 0
;value = 41

[State 4500, screen bound] ; Prevents the camera from following the char
type = ScreenBound
trigger1 = 1
value = 0

[State 4500, position]
type = Posset
trigger1 = time = 0
trigger1 = facing = 1
x = (partner, pos x) - 257
y = ifelse(var(31) > 0,-730,-130)

[State 4500, position]
type = Posset
trigger1 = time = 0
trigger1 = facing = -1
x = (partner, pos x) + 257
y = ifelse(var(31) > 0,-730,-130)

[State 4500, position]
type = Posadd
trigger1 = 1
x = 16

[State 4500, velocity]
type = VelSet
trigger1 = time = 0
y = 3

[State 4500, velocity]
type = Veladd
trigger1 = 1
y = .7

; Tag attack LV1
[State 4501, LV1]
type = ChangeState
trigger1 = time > 7
trigger1 = pos y >= ifelse(var(31) > 0,-600,-0)
value = 7201

;---------------------------------------------------------------------------
;orochi herman's custom level 3 "Shinpi Guren Ken"
[statedef 7201]
type    = s
movetype= a
physics = s
velset = 0,0
anim = 4250
facep2 = 1
ctrl = 0

[State 4512, invincibility]
type = changestate
trigger1 = partner,stateno=[7000,7401];||partner,stateno=7100||partner,stateno=7200||partner,stateno=7300||partner,stateno=70400
value = 7600+(statetype=A)
ignorehitpause = 1

[state 3000, 2]
type = afterimage
trigger1 = partner,var(55) = 0
trigger1 = time = 0
time = 99999999
length = 40
framegap = 6
palcolor = 0  
palinvertall = 0
palbright = 0, 0, 0
palcontrast = 0, 255, 160

[state 3000, 2]
type = afterimage
trigger1 = partner,var(55) = 1
trigger1 = time = 0
time = 99999999
length = 40
framegap = 6
palcolor = 0  
palinvertall = 0
palbright = 0, 0, 0
palcontrast = 255, 40,40

[State 4512, invincibility]
type = varset
trigger1 = time > 0
v = 55
value = 1

[state hehe]
type = posset
trigger1 = time = 0
y = ifelse(var(31) > 0,-600,-0)

[State 3250, 1]
type = PosAdd
triggerall = var(55) < 4 && prevstateno = [200,700]
trigger1 = !time
x = 5

[State 3250, 15]
type = playsnd
triggerall = anim = 4250
trigger1 = animelem = 1
value = s4000,20

[State 3250, 23]
type = statetypeset
triggerall = anim = 4250
trigger1 = animelem = 3
statetype = A
physics = N

[State 3250, 24]
type = playsnd
triggerall = anim = 4250
trigger1 =  animelem = 2
value = s3250,0
volume = 255
channel = 0

[State 3250, 25]
type = playsnd
triggerall = anim = 4250
trigger1 = animelem = 3
value = s4000,14

[State 3250, 26]
type = playsnd
triggerall = anim = 4250
trigger1 = animelem = 3
value = s4000,8

[State 3250, 27]
type = VelSet
triggerall = anim = 4250
trigger1 = AnimElem = 3
x = 5.5
y = -5

[State 3250, 28]
type = Veladd
triggerall = anim = 4250
trigger1 = animelemtime(3) > 0
y = .27


[State 3250, 32]
type = HitDef
trigerall = p2bodydist x < 20
triggerall = P2StateNo != [150,155]
triggerall = p2statetype != A
Trigger1 = animelem = 9
attr = A, HT
hitflag = M
guardflag = M
priority = 1, Miss
sparkno = 6
hitsound = 0+var(49),2
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 4260
p2stateno = 4265
fall = 1
numhits = 1
id = 3250
sparkxy = -20,-63
guard.pausetime = 6,6
ground.velocity = -4.5,-5.5
guard.sparkno = 6+var(30)
guardsound = 0+var(49),8
ground.hittime  = 20
guard.ctrltime = 20
guard.velocity = -8

[State 3250, 33]
type = Changestate
triggerall = anim = 4250
triggerall = animelemtime(4) >= 0
trigger1 = vel Y > 0
trigger1 = pos Y >= 0
value = 4255
;====================================
[Statedef 7300]
type    = a
movetype= a
physics = N
velset = 0,0
anim = 4700
ctrl = 0
poweradd = -3000

[State 4512, invincibility]
type = varset
trigger1 = 1
v = 52
value = 0

[state haha]
type = pause
trigger1 = time = 1
time = 48
movetime = 23
pausebg = 0
ignorehitpause = 1

[State 4512, invincibility]
type = nothitby
trigger1 = 1
value = sca
time = 3

[state 3107, 2]
type = playsnd
trigger1 = time = 0
value = 1,20
channel = 0

[state 4002, 1]
type = explod
trigger1 = time = 1
trigger1 = numexplod(7003) = 0
anim = 7000
id = 7000
postype = back
pos = 0, 0
sprpriority = -3
ownpal = 1
bindtime = -1
supermove = 1
pausemovetime = 9999

[state 4002, 3.2]
type = explod
trigger1 = time = 1
trigger1 = partner,var(55) = 0
anim = F1001
id = 9003
postype = back
pos = 0, 0
sprpriority = -4
ownpal = 1
bindtime = -1
supermovetime = 99999
pausemovetime = 99999
persistent = 0

[state 4002, 3.2]
type = explod
trigger1 = time = 1
trigger1 = partner,var(55) = 1
anim = F1002
id = 9003
postype = back
pos = 0, 0
sprpriority = -4
ownpal = 1
bindtime = -1
supermovetime = 99999
pausemovetime = 99999
persistent = 0

[state 2000, 4]
type = helper
trigger1 = time = 1
trigger1 = partner,var(55) = 0
trigger1 = numhelper(9002) = 0
stateno = 9004
id = 9002
name = "floor"
pos = 0,0
postype = p1
bindtime = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[state 2000, 4]
type = helper
trigger1 = time = 1
trigger1 = partner,var(55) = 1
trigger1 = numhelper(9002) = 0
stateno = 9003
id = 9002
name = "floor"
pos = 0,0
postype = p1
bindtime = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[State 4500, playsnd] 
type = playsnd
trigger1 = time = 0
abspan = 0
value = F4,0

[State 4500, playsnd] 
type = playsnd
trigger1 = time = 0
value = F4,2
volume = 255

;[State 4500, screen bound] ; Prevents the camera from following the char
;type = changeanim
;trigger1 = time = 0
;value = 41

[State 4500, screen bound] ; Prevents the camera from following the char
type = ScreenBound
trigger1 = 1
value = 0

[State 4500, position]
type = Posset
trigger1 = time = 0
trigger1 = facing = 1
x = (partner, pos x) - 257
y = ifelse(var(31) > 0,-730,-130)

[State 4500, position]
type = Posset
trigger1 = time = 0
trigger1 = facing = -1
x = (partner, pos x) + 257
y = ifelse(var(31) > 0,-730,-130)

[State 4500, position]
type = Posadd
trigger1 = 1
x = 16

[State 4500, velocity]
type = VelSet
trigger1 = time = 0
y = 3

[State 4500, velocity]
type = Veladd
trigger1 = 1
y = .7

; Tag attack LV1
[State 4501, LV1]
type = ChangeState
trigger1 = time > 7
trigger1 = pos y >= ifelse(var(31) > 0,-600,-0)
value = 7301

;---------------------------------------------------------------------------
;orochi herman's custom level 3 "Shinpi Guren Ken"
[statedef 7301]
type    = s
movetype= a
physics = s
velset = 0,0
anim = 4300
facep2 = 1
ctrl = 0

[State 4512, invincibility]
type = changestate
trigger1 = partner,stateno=[7000,7401];||partner,stateno=7100||partner,stateno=7200||partner,stateno=7300||partner,stateno=70400
value = 7600+(statetype=A)
ignorehitpause = 1

[state 3000, 2]
type = afterimage
trigger1 = partner,var(55) = 0
trigger1 = time = 0
time = 99999999
length = 40
framegap = 6
palcolor = 0  
palinvertall = 0
palbright = 0, 0, 0
palcontrast = 0, 255, 160

[state 3000, 2]
type = afterimage
trigger1 = partner,var(55) = 1
trigger1 = time = 0
time = 99999999
length = 40
framegap = 6
palcolor = 0  
palinvertall = 0
palbright = 0, 0, 0
palcontrast = 255, 40,40

; Tag attack LV1
[State 4501, LV1]
type = varset
trigger1 = time = 0
trigger1 = partner,var(55) = 1
v = 0
value = 1

[State 4512, invincibility]
type = varset
trigger1 = time > 0
v = 55
value = 1

[state hehe]
type = posset
trigger1 = time = 0
y = ifelse(var(31) > 0,-600,-0)

[State 3500, 13]
type = HitDef
trigger1 = animelem = 8
attr = S,HA
damage = 120,15
animtype = Heavy
guardflag = MA
hitflag = MAF
pausetime = 12,20
sparkno = 6+var(30)
sparkxy = -10,-57
hitsound = 0+var(49),2
guard.sparkno = 0
guardsound = 0+var(49),8
getpower = 0
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
guard.ctrltime = 20
ground.velocity = -10,-14.5
guard.velocity = -8
air.velocity = -4,-14.5
airguard.velocity = -6.67,-1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
getpower = 0,0
snap = 60,0
id = 3500
kill = 0
p2stateno = 6110

[State 3500, 14]
type = veladd
trigger1 = animelem = 5
x = 8

[State 3500, 14]
type = PlaySnd
trigger1 = movehit
value = S3500,2
volume = 255

[State 3500, 15]
type = PlaySnd
trigger1 = movehit
value = S3500,3
volume = 255

[State 3500, 18]
type = nothitby
triggerall = movehit
trigger1 = 1
value = SCA

[State 3500, 19]
type = ScreenBound
triggerall = movehit
trigger1 = 1
movecamera = 0,0
value = 0

[State 3500, 20]
type = ChangeState
triggerall = movehit
trigger1 = 1
value = 4301
ctrl = 0
ignorehitpause = 0

[State 3500, 21]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; landing anim
[statedef 7600]
type    = S
movetype= I
physics = S
velset = 0,0

[State 4512, invincibility]
type = targetstate
trigger1 = prevstateno = 4260 && animelemno(0) < 57
value = 7651
persistent = 0

[State 4512, invincibility]
type = removeexplod
trigger1 = time = 2

[State 4512, invincibility]
type = nothitby
trigger1 = 1
value = SCA

[State 4512, invincibility]
type = changeanim
trigger1 = 1
value = anim
elem = animelemno(0)

[State 4512, invincibility]
type = varset
trigger1 = time = 2
v = 52
value = 0

[State 4512, invincibility]
type = changestate
trigger1 = time = 2
value = 7602

;---------------------------------------------------------------------------
; landing anim
[statedef 7601]
type    = A
movetype= I
physics = N
velset = 0,0

[State 4512, invincibility]
type = targetstate
trigger1 = prevstateno = 4260 && animelemno(0) < 57
value = 7651
persistent = 0

[State 4512, invincibility]
type = varset
trigger1 = time = 1
v = 52
value = 1

[State 4512, invincibility]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 4512, invincibility]
type = changeanim
trigger1 = time < 2
value = anim
elem = animelemno(0)

[State 4512, invincibility]
type = changestate
trigger1 = time = 2
value = 7602

;---------------------------------------------------------------------------
; landing anim
[statedef 7602]
type    = A
movetype= I
physics = N
anim = 43+20*var(40)
velset = -13,-5

[State 4512, invincibility]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 4512, invincibility]
type = changestate
trigger1 = backedgebodydist <= -20
value = 4512



;SPINNING ME ROUND

;-------------------------------------------------------------------------------
; 
[Statedef 7111]
type    = A
movetype= H
physics = N
ctrl = 0
velset = 0,0
anim = 5030

[State 200,End]
type = ChangeState
trigger1 = HitShakeOver
value = 3905;5558
ctrl = 0

;-------------------------------------------------------------------------------
;
[Statedef 7112]
type    = A
movetype= H
physics = N
ctrl = 0
velset = 0,0

[State 200,End]
type = ChangeAnim2
trigger1 = time = 0
value = 3250

[State 200,End]
type = VelSet
trigger1 = time = 0
x = -1;gethitvar(xvel)
y = -15;gethitvar(yvel)

[State 200,End]
type = VelAdd
trigger1 = time >= 0
y = .20

[State 200,End]
type = ChangeAnim
trigger1 = Vel Y > 0
trigger1 = Pos Y > 0
trigger1 = SelfAnimExist(5051)
value = 5051

[State 200,End]
type = ChangeAnim
trigger1 = Vel Y > 0
trigger1 = Pos Y > 0
trigger1 = !SelfAnimExist(5051)
value = 5050

[State 200,End]
type = EnvShake
trigger1 = Pos Y > 0
time = 5

[State 200,End]
type = SelfState
trigger1 = Pos Y > 0
trigger1 = Vel Y > 0
value = 5100
ctrl = 0


;---------------------------------------------------------------------------
; HITG_SHAKE
[Statedef 3905]
type    = S
movetype= H
physics = N
velset = 0,0

[State 3105, 1]
type = ChangeAnim
trigger1 = Time = 0
value = ifelse(SelfAnimExist(5250),5250,ifelse(SelfAnimExist(5051),5051,5030))


[State 3105, 1]
type = ChangeAnim
trigger1 = Time = 0
value = ifelse(SelfAnimExist(5250),5250,ifelse(SelfAnimExist(5051),5051,5030))

[State 3105, 2] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 3105, 3] ;State type gets set to aerial if getting hit up
type = StateTypeSet
trigger1 = Time = 0
trigger1 = GetHitVar(yvel) != 0 && GetHitVar(fall)
trigger2 = Pos Y != 0
type = a

[State 3105, 4]
type = ChangeState
trigger1 = HitShakeOver
value = 3906

[State 3105, FFB Hard]
type = ForceFeedback
trigger1 = 1
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITA_UP (initial going up)
[Statedef 3906]
type    = A
movetype= H
physics = N
ctrl = 0

[State 3106, 1]
type = VelAdd;Gravity
trigger1 = 1
y = GetHitVar(yaccel)

[State 3106, 2]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 3106, 4]
type = SelfState
triggerall = HitFall
trigger1 = Vel Y > 0    ;Hit ground
trigger1 = Pos Y >= 10  ;.
value = 5050 ;HITA_FALL

[State 3106, 5]
type = ChangeState
trigger1 = Vel Y > -1
value = 3907 ;HITA_UP (transition)

;---------------------------------------------------------------------------
; HITA_UP_T (transition)
[Statedef 3907]
type    = A
movetype= H
physics = N

[State 3107, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5251)
value = 5251

[State 3107, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5251) = 0
trigger1 = SelfAnimExist(5061)
value = 5061
;trigger1 = SelfAnimExist(5035)
;value = 5035

[State 3107, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 3107, 4]
type = SelfState
triggerall = HitFall
trigger1 = Vel Y > 0    ;Hit ground
trigger1 = Pos Y >= 10  ;.
value = 5110 ;HITA_FALL








[Statedef 3851]
type    = A
movetype= H
physics = N
velset = 0,0
facep2 = 1

[State 3051, 1]
type = ChangeAnim2
trigger1 = 1
value = 1053

[state 1250, turn]
type = turn
trigger1 = p2bodydist x < -10

[State 3051, 2]
type = ChangeState
trigger1 = HitShakeOver = 1
value = 3852



[Statedef 3852]
type    = A
movetype= H
physics = N
facep2= 1

[State 3052, 1]
type = HitVelSet
trigger1 = Time = 0
x = 2
y = 1

[State 3052, 2]
type = VelAdd
trigger1 = 1
y = .5

[State 3052, 4]
type = ChangeState
triggerall = Pos Y < -15
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 3853

[State 3052, 5]
type = SelfState
trigger1 = (Vel Y > 0) && (Pos Y >= 0)
value = 5100



[Statedef 3853]
type    = A
movetype= H
physics = N
facep2 = 1

[State 3053, 1]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 10)

[State 3053, 2]
type = PosAdd
trigger1 = Time = 0
x = 5 - BackEdgeBodyDist

[State 3053, 3]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 1090, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 0,29
channel = 0


[State 3053, 5]
type = ChangeAnim2
trigger1 = Time = 0
value = 1054



[State 3053, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 3854



[Statedef 3854]
type    = A
movetype= H
physics = N

[State 3054, 1]
type = Hitfallset
trigger1 = Time = 0
value = 0

[State 3054, 2]
type = VelSet
trigger1 = Time = 0
y = -8
[State 3054, 3]
type = VelSet
trigger1 = Time = 0
x = 5


[State 3054, 4]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 3054, 5]
type = VelAdd
trigger1 = 1
y = .8

[State 3054, 6]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 3054, 7]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 3054, 8]
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 3054, 9]
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5061)
persistent = 0
value = 5061

[State 3054, 10]
type = SelfState
trigger1 = (Vel Y > 0) && (Pos Y >= 0)
value = 5100



;-------------------------------------------------------------------------------
; Dizzy pt.1
[Statedef 970]
type    = A
movetype= H
physics = N
ctrl = 0
anim = 5250
poweradd = 0
velset = -2,-15.5
sprpriority = 1

[State 970, 0]
type = NotHitBy
trigger1 = 1
value = SCA
time = 20

[State 970, 1]
type = PlaySnd
trigger1 = Time = 0
value = 5000,3

[State 970, 2]
type = VelAdd
trigger1 = 1
y = 0.46

;This resets the dizzy counter back to zero
[State 970, 3]
type = VarSet
trigger1 = Time = 0
v = 35
value = 0

;This variable makes it so that you can't get re-dizzied
[State 970, 4]
type = VarSet
trigger1 = Time = 0
v = 37
value = 1

;This changes to the spiraling down anim once you start going down
[State 970, 5]
type = ChangeAnim
trigger1 = (Vel Y >= 0) && (Anim != 5251)
value = 5251

[State 970, 6]
type = ChangeState
trigger1 = (Pos Y >= 0) && (Vel Y > 0)
value = 9701
;---------------------------------------------------------------------------
; Dizzy pt.2
[Statedef 9701]
type    = S
movetype= I
physics = S
ctrl = 0
poweradd = 0
velset = 0,0
sprpriority = 0

[State 971, 0]
type = Explod
trigger1 = Time = 0
anim = 9999
pos = 15,0
postype = p1
sprpriority = 2
ownpal = 1

[State 971, 1]
type = ChangeAnim
trigger1 = Time = 0
value = 5302
elem = 1

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
value = F7, 2

[State 5110, 6]
type = PlaySnd
trigger1 = Animelem = 1
value = s5302, 0

[State 971, 3]
type = PosSet
trigger1 = Time = 0
y = 0

[State 971, 4]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 971, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 9702
;---------------------------------------------------------------------------
; Dizzy pt.3
[Statedef 9702]
type    = S
movetype= I
physics = S
ctrl = 0
poweradd = 0
anim = 5300
velset = 0,0
sprpriority = 0

[State 972, 0]
type = PlaySnd
trigger1 = Time = 1
value = S5000,4
volumescale = 100

[State 972, 0]
type = PlaySnd
trigger1 = Time = 1
value = S4150,0

[State 972, 1]
type = Explod
trigger1 = Time = 0
anim = 8196
id = 8196
postype = P1
pos = 18,8
ownpal = 1
sprpriority = 4
facing = -1
bindtime = -1
removetime = -1
removeongethit = 1
scale = .83,1

[State 972, 2]
type = RemoveExplod
trigger1 = Time = 150
id = 8196

[State 972, 3]
type = RemoveExplod
trigger1 = command = "undizzy"
id = 8196

[State 972, 4]
type = ChangeState
trigger1 = command = "undizzy"
value = 0
ctrl = 1

[State 972, 5]
type = ChangeState
trigger1 = Time = 155
value = 0
ctrl = 1
persistent = 0



;--------------------------------------------------------------------------
;Flyingscreen Effect
;--------------------------------------------------------------------------
[Statedef 750]
type    = S
movetype= I
physics = N
poweradd= 0
velset = 0,0
ctrl = 0
anim = 888888
;FACEP2 =1

[State 33117]
type = RemoveExplod
trigger1 = Time = 0
id = 3103

[State 750,ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 750,NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 18

[State 750,PosSet]
type = PosSet
trigger1 = Time = 0
y = 0

[State 750,PosAdd]
type = PosAdd
trigger1 = Time = 40
x = (-1 * BackEdgeBodyDist) + (-50)

[State 750,PlaySnd]
type = PlaySnd
trigger1 = Time = 10
value = S10,13

[State 750,ChangeState]
type = ChangeState
trigger1 = Time = 20
value = 100
ctrl = 0


;---------------------------------------------------------------------------
; waiting off screen after aerial rave
[statedef 7710]
type    = S
physics = S
poweradd= 0
velset = 0,0
ctrl = 0
anim = 0

[State 750,ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 750,NotHitBy]
type = nothitby
trigger1 = 1
value = sca, aa, ap, at, na, np, nt, sa, sp, st, ha, hp, ht
time = 2
ignorehitpause = 1

[state 750,2]
type = assertspecial
trigger1 = 1
flag = invisible

[state 710,3]
type = posset
trigger1 = Facing = 1
x = -300
y = 0

[state 710,4]
type = posset
trigger1 = Facing = -1
x = 300
y = 0

[State 750,PosAdd]
type = PosAdd
trigger1 = Time = 40
x = (-1 * BackEdgeBodyDist) + (-50)

[State 750,PlaySnd]
type = PlaySnd
trigger1 = Time = 10
value = S2,1

[state 750]
type = envshake
trigger1 = p2stateno = 328
persistent = 0
time = 15
freq = 70
ampl = -4

[State 750,ChangeState]
type = ChangeState
trigger1 = p2stateno = 328
trigger2 = Time = 20
value = 7711
ctrl = 0

; 
[statedef 7711]
type    = S
physics = N
anim = 100
sprpriority = 1


[State 100, 1]
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 1
x = 10


[State 100, 2]
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 100, 3]
type = PlaySnd
trigger1 = time = 3
value = 5547, 0


[state 100, 4]
type = explod
trigger1 = time = 4
id = 100
anim = 9100
postype = p1
pos = 0,0
ownpal = 1
bindtime = 1
sprpriority = 5
persistent = 0
removeongethit = 1

[State 100, 10]
type = ChangeState
trigger1 = time = 10
value = 52




;marvelous!-----------------------------------------------------------------
;---------------------------------------------------------------------------
; aerial raved a
[statedef 7715]
movetype= h
physics = n
velset = 0,0
ctrl = 0

[state 710,1]
type = selfstate
trigger1 = time = 0 && pos y >= 0 && command != "holddown"
value = 5000

[state 710,2]
type = selfstate
trigger1 = time = 0 && pos y >= 0 && command = "holddown"
value = 5010

[state 710,3]
type = statetypeset
trigger1 = time = 1
statetype = a

[state 710,4]
type = changeanim
trigger1 = 1
value = 5012

[state 710,5]
type = changestate
trigger1 = hitshakeover
value = 7716
;---------------------------------------------------------------------------
; aerial raved b
[statedef 7716]
type    = a
movetype= h
physics = n
ctrl = 0

[state 711, 1]
type = veladd
trigger1 = 1
y = 0.5

[state 711, 2]
type = hitvelset
trigger1 = time = 0
x = 1
y = 1

[state 711, 3]
type = changestate
trigger1 = animtime = 0 || time >= 10
value = 7717

[state 711, 4]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,1

[state 711, 2]
type = changeanim
trigger1 = selfanimexist(5060) && anim != 5060
value = 5060

[state 711, 6]
type = changestate
trigger1 = pos y >= 10 && vel y > 0
value = 328
;---------------------------------------------------------------------------
; aerial raved c
[statedef 7717]
type    = a
movetype= h
physics = n
ctrl = 0

[state 712, 1]
type = veladd
trigger1 = 1
y = 0.5

[state 712, 2]
type = changeanim
trigger1 = selfanimexist(5060) && anim != 5060
value = 5060

[state 712, 3]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,1

[state 712, 3]
type = changestate
trigger1 = pos y >= 10 && vel y > 0
value = 328
;------------------------------------------
; custom vs series hit back - shaking
[statedef 6010]
type    = a
movetype= h
physics = n
anim = 5012
velset = 0,0

[state 6000, 1]
type = changestate
trigger1 = hitshakeover
value = 6001

[state 6000, Ffb light]
type = ForcefeeDBack
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[state 6000, Ffb medium]
type = ForcefeeDBack
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[state 6000, Ffb hard]
type = ForcefeeDBack
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; not aerial raved a
[statedef 7700]
movetype= h
physics = n
velset = 0,0
ctrl = 0

[state 700,1]
type = selfstate
trigger1 = time = 0 && pos y >= 0 && command != "holddown"
value = 5000

[state 700,2]
type = selfstate
trigger1 = time = 0 && pos y >= 0 && command = "holddown"
value = 5010

[state 700, 3]
type = statetypeset
trigger1 = time = 1
statetype = a

[state 700, 4]
type = changeanim
trigger1 = 1
value = 5012

[state 700, 5]
type = changestate
trigger1 = hitshakeover
value = 7701
;---------------------------------------------------------------------------
; not aerial raved b
[statedef 7701]
type    = a
movetype= h
physics = n
ctrl = 0

[state 701, 1]
type = veladd
trigger1 = 1
y = 0.5

[state 701, 2]
type = hitvelset
trigger1 = time = 0
x = 1
y = 1

[state 701, 3]
type = selfstate
trigger1 = !alive && pos y >= 0 && vel y > 0
value = 5100

[state 701, 4]
type = changestate
trigger1 = animtime = 0 || time >= 10
value = 7702

[state 701, 5]
type = changestate
trigger1 = alive && pos y >= 10 && vel y > 0
value = 7703
;---------------------------------------------------------------------------
; not aerial raved c
[statedef 7702]
type    = a
movetype= h
physics = n
ctrl = 0

[state 702, 1]
type = veladd
trigger1 = 1
y = 0.5

[state 702, 2]
type = changeanim
trigger1 = time = 0 && selfanimexist(5061)
value = 5061

[state 702, 3]
type = changestate
trigger1 = pos y >= 10 && vel y > 0 && alive
value = 7703

[state 702, 4]
type = selfstate
trigger1 = pos y >= 0 && vel y > 0 && !alive
value = 5100
;---------------------------------------------------------------------------
; not aerial raved D
[statedef 7703]
type    = a
movetype= h
physics = n
anim = 5210
ctrl = 0

[state 703, 1]
type = posfreeze
trigger1 = time = 0
value = 4

[state 703, 2]
type = velset
trigger1 = time = 0
x = vel x / 2
y = -8

[state 703, 3]
type = turn
trigger1 = p2dist x < -10 && time = 0
persistent = 0

[state 703, 4]
type = nothitby
trigger1 = 1
value = sca
time = 1

[state 703, 5]
type = veladd
trigger1 = 1
y = .6

[state 703, 6]
type = selfstate
trigger1 = pos y >= 0 && vel y > 0
value = 52
ctrl = 1

;---------------------------------------------------------
; custom vs series hit back - Fly back
[statedef 6001]
type    = a
movetype= h
physics = n
anim = 5030
ctrl = 0

[state 6001, 1]
type = hitvelset
trigger1 = time = 0
x = 1
y = 1

[state 6001, 2]
type = veladd
trigger1 = 1
y = gethitvar(yaccel)

[state 6001, 3]
type = changeanim
trigger1 = time = 0
trigger1 = selfanimexist(5035)
trigger1 = anim != [5051,5059]
trigger1 = anim != 5090
value = 5035

[state 6001, 4]
type = changeanim
triggerall = animtime = 0
trigger1 = anim = 5030
trigger2 = anim = 5035
value = 5050

[state 6001, 4]
type = changeanim
trigger1 = anim = 5030 && time = 10
trigger2 = anim = 5035 && time = 10
value = 5050

[state 6001, 6]
type = changestate
trigger1 = backedgedist <= 10
value = 6002

[state 6001, 7]
type = changestate
trigger1 = Frontedgedist <= 10
value = 6003

[state 6001, 8]
type = changestate
trigger1 = (vel y > 0) && (pos y >= 5)
trigger1 = alive
value = 6005

[state 6001, 9]
type = selfstate
trigger1 = (vel y > 0) && (pos y >= 0)
trigger1 = alive = 0
value = 5100

;---------------------------------------------------------
; custom vs series hit back - wall explod trigger (1)
[statedef 6002]
type    = a
movetype= h
physics = n

[state 6002, 1]
type = posfreeze
trigger1 = time = 0
value = 4

[state 6002, 2]
type = varset
trigger1 = time = 0
var(13) = 1

[state 6002, 3]
type = changestate
trigger1 = time = 1
value = 6004

[state 6002, 4]
type = ForcefeeDBack
trigger1 = time = [30,72]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------
; custom vs series hit back - wall explod trigger (2)
[statedef 6003]
type    = a
movetype= h
physics = n

[state 6003, 1]
type = posfreeze
trigger1 = time = 0
value = 4

[state 6003, 2]
type = varset
trigger1 = time = 0
var(13) = 1

[state 6003, 3]
type = changestate
trigger1 = time = 1
value = 6004

[state 6003, 4]
type = ForcefeeDBack
trigger1 = time = [30,72]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------
; custom vs series hit back - Fly back continue
[statedef 6004]
type    = a
movetype= h
physics = n
ctrl = 0

[state 6004, 1]
type = veladd
trigger1 = 1
y = gethitvar(yaccel)

[state 6004, 2]
type = changeanim
triggerall = animtime = 0
trigger1 = anim = 5030
trigger2 = anim = 5035
value = 5050

[state 6004, 4]
type = changestate
trigger1 = (vel y > 0) && (pos y >= 5)
trigger1 = alive
value = 6005

[state 6004, 5]
type = selfstate
trigger1 = (vel y > 0) && (pos y >= 0)
trigger1 = alive = 0
value = 5100

;---------------------------------------------------------
; custom vs series hit back - recover
[statedef 6005]
type    = a
movetype= i
physics = n
anim = 5160

[state 6005, 0]
type = changeanim
trigger1 = time = 6
trigger1 = anim = 5160
value = 5200

[state 6005, 1]
type = posfreeze
trigger1 = pos y < 200
trigger1 = time = 0
value = 4

[state 6005, 2]
type = velset
trigger1 = time = 0
y = -1*const(movement.yaccel)

[state 6005, 5]
type = veladd
trigger1 = 1
y = const(movement.yaccel)

[state 6005, 6]
type = posset
trigger1 = time = 0
y = 0

[state 6005, 7]
type = nothitby
trigger1 = 1
value = sca
time = 2

[state 6005, 8]
type = selfstate
trigger1 = (vel y > 0) && (pos y >= 0)
value = 52
ctrl = 1

; custom vs series hit Up - shaking
[statedef 6100]
type    = a
movetype= h
physics = n
velset = 0,0

[state 326, 1]
type = changeanim
trigger1 = time < 9
value = ifelse(selfanimexist(5052),5052,(ifelse(selfanimexist(5051),5051,5050)))

[state 6100, 1]
type = changestate
trigger1 = hitshakeover
value = 6101

;---------------------------------------------------------
; custom vs series hit Up - Fly Up
[statedef 6101]
type    = a
movetype= h
physics = n
ctrl = 0

[state 6101, 1]
type = changeanim
trigger1 = time = 0
trigger1 = (gethitvar(animtype) = [4,5]) && (selfanimexist(5047 + gethitvar(animtype)))
value = 5047 + gethitvar(animtype) ;5051 - 4 + type

[state 6101, 2]
type = hitvelset
trigger1 = time = 0
x = 1
y = 1

[state 6101, 3]
type = veladd
trigger1 = 1
y = gethitvar(yaccel)

[state 6101, 4]
type = changeanim
trigger1 = time = 0
trigger1 = selfanimexist(5035)
trigger1 = anim != [5051,5059] ;not if in hit Up anim
trigger1 = anim != 5090 ;not if hit off ground anim
value = 5035

;[state 6101, 5]
;type = changeanim
;triggerall = animtime = 0
;trigger1 = anim = 5030
;trigger2 = anim = 5035
;value = 5050

[state 6101, 6]
type = changestate
trigger1 = hitover
trigger2 = animtime = 0
trigger3 = vel y > 0
trigger3 = pos y >= 10
trigger4 = time = 0
trigger4 = anim != 5035
value = 6102

;---------------------------------------------------------
; custom vs series hit Up - recover
[statedef 6102]
type    = a
movetype= h
physics = n

[state 6102, 1]
type = changeanim
trigger1 = animtime = 0
trigger1 = anim = 5035
trigger2 = time = 0
trigger2 = anim != 5035
trigger2 = (anim != [5051, 5059]) && (anim != [5061, 5069])
trigger2 = anim != 5090
value = 5050

[state 6102, 3]
type = veladd
trigger1 = 1
y = .42;gethitvar(yaccel)

[state 6102, 4]
type = selfstate
triggerall = alive = 1
trigger1 = (time = 15) || (vel y >= 0)
value = 5040

[state 6102, 4]
type = selfstate
triggerall = alive = 0
trigger1 = (time = 15) || (vel y >= 0)
value = 5050

[state 6102, 5]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 5100

;---------------------------------------------------------------------------
; tripped (shaking)
[statedef 326]
type    = a
movetype= h
physics = n
velset = 0,0

[state 326, 1]
type = changeanim
trigger1 = 1
value = 5070

[state 326, 2]
type = changestate
trigger1 = hitshakeover
value = 327

[state 326, 3]
type = ForcefeeDBack
trigger1 = time = 0
time = 12
waveform = sinesquare
ampl = 140

[state 326,4]
type = nothitby
trigger1 = 1
value = sca, aa, ap, at, na, np, nt, sa, sp, st, ha, hp, ht
time = 2
ignorehitpause = 1

[state 326,5]
type = playerpush
trigger1 = 1
value = 0
;---------------------------------------------------------------------------
; tripped (fall through air)
[statedef 327]
type    = a
movetype= h
physics = n

[state 327, 1]
type = hitvelset
trigger1 = time = 0
x = 1
y = 1

[state 327, 2] ;acceleration
type = veladd
trigger1 = 1
y = gethitvar(yaccel)

[state 327, 3] ;hit ground
trigger1 = vel y > 0
trigger1 = pos y >= 15
type = changestate
value = 328

[state 327,4]
type = nothitby
trigger1 = 1
value = sca, aa, ap, at, na, np, nt, sa, sp, st, ha, hp, ht
time = 2
ignorehitpause = 1

[state 327,5]
type = playerpush
trigger1 = 1
value = 0
;---------------------------------------------------------------------------
; trip liedown
[statedef 328]
type    = l
movetype= h
physics = n

[state 328, envshake]
type = Fallenvshake
trigger1 = time = 0

[state 328, 1] ;for hit Up/Up-diag type (from state 5081)
type = changeanim
persistent = 0
trigger1 = selfanimexist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[state 328, 2] ;hit ground anim (normal)
type = changeanim
triggerall = time = 0
triggerall = anim != [5110,5119] ;not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !selfanimexist(5170 + (anim % 10))
value = 5170

[state 328, 3] ;hit ground anim (for hit Up)
type = changeanim
triggerall = time = 0
triggerall = anim != [5110,5119] ;not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = selfanimexist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[state 328, 4]
type = hitfalldamage
trigger1 = time = 0

[state 328, 5]
type = posset
trigger1 = time = 0
y = 0

[state 328, var]
type = varset
trigger1 = time = 0
trigger1 = gethitvar(fall.yvel) != 0
sysvar(1) = Floor(vel y)

[state 328, 6]
type = playsnd
triggerall = prevstateno != [715,720]
trigger1 = time = 0 && !sysvar(0)
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[state 328, 6]
type = playsnd
triggerall = prevstateno = 720
trigger1 = time = 0 && !sysvar(0)
value = s20, 7

[state 328, 8]
type = velset
trigger1 = 1
x = 0
y = 0

[state 328, 9] ;for hit Up type
type = changeanim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = selfanimexist(5110 + (anim % 10))
trigger1 = animtime = 0
trigger2 = sysvar(0) ;sysvar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[state 328, 10] ;for normal
type = changeanim
persistent = 0
triggerall = anim != [5111,5119]
trigger1 = animtime = 0
trigger2 = sysvar(0) ;sysvar(0) = 1 avoids hit ground Frame
value = 5110

[state 328, 11] ;if just Died
type = selfstate
triggerall = !alive
trigger1 = animtime = 0
trigger2 = sysvar(0) ;sysvar(0) = 1 avoids hit ground Frame
trigger3 = anim = [5110,5119]
value = 5150

[state 328, 12]
type = varset
trigger1 = sysvar(0)
trigger1 = time = 0
sysvar(0) = 0

[state 328, 13] ;friction
type = velmul
trigger1 = 1
x = 0.85

[state 328, 14]
type = ForcefeeDBack
trigger1 = alive
trigger1 = time = 0
time = 8
ampl = 240
waveform = sine

[state 328, 15]
type = ForcefeeDBack
trigger1 = !alive
trigger1 = time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 328,16]
type = playerpush
trigger1 = 1
value = 0

[state 328,17]
type = nothitby
trigger1 = time = 0
value = sca, aa, ap, at, na, np, nt, sa, sp, st, ha, hp, ht
time = 0
ignorehitpause = 1

[state 250,13]
type = envshake
trigger1 = time = 0 && prevstateno = 720
persistent = 0
time = 15
freq = 70
ampl = -4

[state 328,18]
type = selfstate
trigger1 = alive && time = 7 && (prevstateno != [700,709]) && prevstateno != 720
trigger2 = alive && time = 9 && prevstateno = [700,709]
trigger3 = alive && time = 12 && prevstateno = 720
value = 5120

;=============================================================
; trip liedown
[statedef 329]
type    = A
movetype= I
physics = N
anim = 9999

[state 250,11]
type = explod
trigger1 = time = 0
persistent = 0
anim = 6012
pos = -120,-5
postype = p2
sprpriority = 5
velocity = 0, 0
bindtime = 1
ownpal = 1

[state 250,12]
type = explod
trigger1 = time = 0
persistent = 0
anim = 6013
pos = -120,-5
postype = p2
sprpriority = -5
velocity = 0, 0
bindtime = 1
ownpal = 1

[state 250,13]
type = envshake
trigger1 = time = 0
persistent = 0
time = 15
freq = 70
ampl = -4

[state 250,15]
type = playsnd
trigger1 = time = 0
persistent = 0
value = s0, 11

[state 250,15]
type = destroyself
trigger1 = time = 6

[Statedef 330]
type = A
movetype = H
physics = N
sprpriority = 0
ctrl = 0
velset = 0,0

[State 805, ChangeAnim2]
type = ChangeAnim2
trigger1 = Time = 0
value = 330

[State 2052, veladd]
type = velset
trigger1 = time = 2
x = -5
y = -25

[State 2052, veladd]
type = veladd
trigger1 = time > 9
y = .9

[State 861, SelfState]
type = SelfState
trigger1 = time = 20
value = 5040
ctrl = 1
;---------------------------------------------------------------------------
; hitg_shake
[statedef 9000]
type    = s
movetype= h
physics = n
velset = 0,0

[state 5000, 1] ;anim For hit_light to hit_hard
type = changeanim
trigger1 = time = 0
trigger1 = gethitvar(animtype) != [3,5]
value = ifelse((gethitvar(groundtype) = 1),5000,5010) + gethitvar(animtype)

[state 5000, 2] ;anim For hit_back
type = changeanim
trigger1 = time = 0
trigger1 = gethitvar(animtype) = [3,5]
value = 5030

[state 5000, 3] ;anim For hit_up/hit_diagup (only if it exists)
type = changeanim
trigger1 = time = 0
trigger1 = (gethitvar(animtype) = [4,5]) && (selfanimexist(5047 + gethitvar(animtype)))
value = 5047 + gethitvar(animtype) ;5051 - 4 + type

[state 5000, 4] ;freeze anim
type = changeanim
trigger1 = time > 0
value = anim

[state 5000, 5] ;state type gets set to aerial if getting hit Up
type = statetypeset
trigger1 = time = 0
trigger1 = gethitvar(yvel) != 0 && gethitvar(fall)
trigger2 = pos y != 0
statetype = a

[state 5000, 6]
type = selfstate
trigger1 = hitshakeover
trigger1 = gethitvar(yvel) = 0
value = 5001 ;hitg_slide

[state 5000, 7]
type = changestate
trigger1 = hitshakeover
value = 9030

[state 5000, Ffb light]
type = ForcefeeDBack
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[state 5000, Ffb medium]
type = ForcefeeDBack
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[state 5000, Ffb hard]
type = ForcefeeDBack
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; hitc_shake
[statedef 9010]
type    = c
movetype= h
physics = n
velset = 0,0

[state 5010, 1] ;anim For hit_light to hit_hard
type = changeanim
trigger1 = time = 0
trigger1 = gethitvar(animtype) != [3,5]
value = 5020 + gethitvar(animtype)

[state 5010, 2] ;anim For hit_back
type = changeanim
trigger1 = time = 0
trigger1 = gethitvar(animtype) = [3,5]
value = 5030

[state 5010, 3] ;anim For hit_up/hit_diagup (only if it exists)
type = changeanim
trigger1 = time = 0
trigger1 = (gethitvar(animtype) = [4,5]) && (selfanimexist(5047 + gethitvar(animtype)))
value = 5047 + gethitvar(animtype) ;5051 - 4 + type

[state 5010, 4] ;freeze anim
type = changeanim
trigger1 = time > 0
value = anim

[state 5010, 5]
type = selfstate
trigger1 = hitshakeover
trigger1 = gethitvar(yvel) = 0
value = 5011 ;hitc_slide

[state 5010, 6]
type = changestate
trigger1 = hitshakeover
value = 9030

[state 5010, Ffb light]
type = ForcefeeDBack
trigger1 = anim = 5020
persistent = 0
time = 6
waveform = square

[state 5010, Ffb medium]
type = ForcefeeDBack
trigger1 = anim = 5021
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[state 5010, Ffb hard]
type = ForcefeeDBack
trigger1 = anim = 5022
persistent = 0
time = 15
waveform = sinesquare
ampl = 140


;---------------------------------------------------------------------------
; hita_shake
[statedef 9020]
type    = a
movetype= h
physics = n
velset = 0,0

[state 5020, 1] ;anim For hit_light to hit_hard
type = changeanim
trigger1 = time = 0
trigger1 = gethitvar(animtype) != [3,5]
value = ifelse((gethitvar(airtype) = 1),5000,5010) + gethitvar(animtype)

[state 5020, 2] ;anim For hit_back
type = changeanim
trigger1 = time = 0
trigger1 = gethitvar(animtype) = [3,5]
value = 5030

[state 5020, 3] ;anim For hit_up/hit_diagup (only if it exists)
type = changeanim
trigger1 = time = 0
trigger1 = (gethitvar(animtype) = [4,5]) && (selfanimexist(5047 + gethitvar(animtype)))
value = 5047 + gethitvar(animtype) ;5051 - 4 + type

[state 5020, 4] ;freeze anim
type = changeanim
trigger1 = time > 0
value = anim

[state 5020, 5]
type = changestate
trigger1 = hitshakeover
value = 9030

[state 5020, Ffb light]
type = ForcefeeDBack
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[state 5020, Ffb medium]
type = ForcefeeDBack
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[state 5020, Ffb hard]
type = ForcefeeDBack
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140
;---------------------------------------------------------------------------
; hita_up (initial going Up)
[statedef 9030]
type    = a
movetype= h
physics = n
ctrl = 0

[state 5010, 4] ;freeze anim
type = changeanim
triggerall = vel Y < 0
trigger1 = anim = 5030
trigger1 = time > 0
trigger2 = anim = 5035
trigger2 = time > 0
value = anim

[state 5035, 1]
type = changeanim
trigger1 = animtime = 0
trigger1 = selfanimexist(5035)
trigger1 = anim != [5051,5059] ;not if in hit Up anim
trigger1 = anim != 5090 ;not if hit off ground anim
value = 5035

[state 5030, 1]
type = veladd
trigger1 = 1
y = gethitvar(yaccel)

[state 5030, 2]
type = hitvelset
trigger1 = time = 0
x = 1
y = 1

[state 5050, 2] ;coming Down anim
type = changeanim
trigger1 = vel y >= 0
value = 5060
persistent = 0

[state 5030, 3]
type = selfstate
triggerall = !hitfall
trigger1 = hitover
value = 5040 ;hita_recov

[state 5030, 3]
type = changestate
triggerall = !hitfall
trigger1 = vel y > 0    ;hit ground
trigger1 = pos y >= 10  ;.
value = 9040 ;hita_recov

[state 5030, 4]
type = selfstate
triggerall = hitfall
trigger1 = hitover
trigger2 = vel y > 0    ;hit ground
trigger2 = pos y >= 10  ;.
value = 5050 ;hita_fall

;---------------------------------------------------------------------------
; hita_recov (recovering in air, not Falling)
[statedef 9040]
type    = a
movetype= h
physics = n

[state 5100,2]
type = playsnd
trigger1 = Authorname = "Beximus"
trigger1 = time = 0
value = 0,32

[state 5100, 4]
type = posfreeze
trigger1 = 1
value = 1

[state 5040, 2]
type = velset
trigger1 = time = 1
trigger1 = gethitvar(animtype) = 0
y = -4

[state 5040, 2]
type = velset
trigger1 = time = 1
trigger1 = gethitvar(animtype) = 1
y = -4.9

[state 5040, 2]
type = velset
trigger1 = time = 1
trigger1 = gethitvar(animtype) = 2
y = -5.3

[state 5040, 2]
type = velset
trigger1 = time = 1
trigger1 = gethitvar(animtype) > 2
y = -5.3 - (vel y/10.0)

[state 5040, 2]
type = selfstate
trigger1 = time = 1
value = 5040

;------------------------------------------------------------
;
[statedef 9080]
type    = l
movetype= h
physics = n

[state 5080, 3] ;freeze
type = changeanim
trigger1 = 1
value = anim

[state 5080, 4]
type = selfstate
trigger1 = hitshakeover
trigger1 = gethitvar(yvel) = 0
value = 5081 ;hitl_slide

[state 5080, 5]
type = changestate
trigger1 = hitshakeover
trigger1 = gethitvar(yvel) != 0
value = 9081 ;hita_up


;---------------------------------------------------------------------------
; hita_up (initial going Up)
[statedef 9081]
type    = a
movetype= h
physics = n
ctrl = 0

[state 5030, 1]
type = veladd;gravity
trigger1 = 1
y = gethitvar(yaccel)

[state 5030, 2]
type = hitvelset
trigger1 = time = 0
x = 1
y = 1

[state 5030, 4]
type = changestate
triggerall = hitfall
trigger1 = hitover
trigger2 = vel y > 0    ;hit ground
trigger2 = pos y >= 10  ;.
value = 9082 ;hita_fall

;---------------------------------------------------------------------------
; hita_fall (knocked Up, Falling)
[statedef 9082]
type    = a
movetype= h
physics = n

[state 5050, 1] ;change anim when Done with transition
type = changeanim
trigger1 = animtime = 0
trigger1 = anim = 5035
trigger2 = time = 0     ;if no transition anim
trigger2 = anim != 5035
trigger2 = (anim != [5051, 5059]) && (anim != [5061, 5069])
trigger2 = anim != 5090 ;not if hit off ground anim
value = 5050

[state 5050, 2] ;coming Down anim
type = changeanim
trigger1 = anim = [5050,5059]
trigger1 = vel y >= ifelse(anim < 5052, 1, -2)
trigger1 = selfanimexist(anim+10)
value = anim+10
persistent = 0

[state 5050, 2] ;coming Down anim
type = changeanim
trigger1 = anim = 5051
trigger1 = animtime = 0
value = 5061
persistent = 0

[state 5050, 3] ;gravity
type = veladd
trigger1 = 1
y = gethitvar(yaccel)

[state 5050, 6]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 9083 ;hit_bounce

;---------------------------------------------------------------------------
; hit_bounce (hit ground)
[statedef 9083]
type    = l
movetype= h
physics = n

[state 5100, 1]
type = velset
trigger1 = time = 0
trigger1 = gethitvar(fall.yvel) = 0
trigger1 = vel x > 1
x = 1

[state 5100, envshake]
type = Fallenvshake
trigger1 = time = 0

[state 5100, 2] ;hit ground anim (normal)
type = changeanim
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !selfanimexist(5100 + (anim % 10))
value = 5100

[state 5100, 3] ;hit ground anim (for hit Up)
type = changeanim
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = selfanimexist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[state 5100, 4]
type = posset
trigger1 = time = 0
y = 0

[state 5100, 5]
type = velset
trigger1 = time = 0
y = 0

[state 5100, 6] ;reduce speed
type = velmul
trigger1 = time = 0
x = 0.75

[state 5100, 7]
type = selfstate
trigger1 = time = 0
trigger1 = gethitvar(fall.yvel) = 0
value = 5120 ;hit_liedown

;---------------------------------------------------------------------------
; Override common states (use same number to override) :
;---------------------------------------------------------------------------






;[FLOOR STATE];

;floor
[statedef 9922]
type    = a
movetype= a
physics = n
ctrl = 0
anim = 9999
sprpriority = -9

[state 710,6]
type = assertspecial
trigger1 = 1
flag = nobg
flag2 = nofg

[state 710,6]
type = posset
trigger1 = time > 0
x = 0
y = 0

[state 4002, super bg]
type = explod
trigger1 = enemynear, numhelper(9922) = 0
trigger1 = numexplod(9913) = 0
trigger1 = time >= 0
anim = 9118
ownpal = 1
id = 9001
bindtime = 9999
removetime = -1
removeongethit = 1
postype = back
pos = 160, 85
sprpriority = -9
persistent = 0


[state 710, 6]
type = removeexplod
trigger1 = parent, var(10) <= 0
trigger1 = parent, movetype != a
;trigger2 = time = 120
ID = 9001

[state 710, 6]
type = Destroyself
trigger1 = parent, var(10) <= 0
trigger1 = parent, movetype != a
;trigger2 = time = 120



;floor  LEVEL 3
[statedef 9924]
type    = a
movetype= a
physics = n
ctrl = 0
anim = 9999
sprpriority = -9

[state 710,6]
type = assertspecial
trigger1 = 1
flag = nobg
flag2 = nofg

[state 710,6]
type = posset
trigger1 = time > 0
x = 0
y = 0

[state 4002, super bg]
type = explod
trigger1 = enemynear, numhelper(9923) = 0
trigger1 = numexplod(9913) = 0
trigger1 = time >= 0
anim = 9128
ownpal = 1
id = 9001
bindtime = 9999
removetime = -1
removeongethit = 1
postype = back
pos = 160, 85
sprpriority = -9
persistent = 0
supermove  = 1

[state 710, 6]
type = removeexplod
trigger1 = parent, var(10) <= 0
trigger1 = parent, movetype != a
;trigger2 = time = 30
ID = 9001

[state 710, 6]
type = Destroyself
trigger1 = parent, var(10) <= 0
trigger1 = parent, movetype != a
trigger2 = anim = 9120


;---------------------------------------------------------------------------

; Super Jump 
[Statedef 2600]
type    = A
movetype = I
physics = A
ctrl = 1

[State 0]
type = Explod
trigger1 =Time = 0
ID = 474
anim = 6060
postype = p1
pos = 0, 6
bindtime = 1
removetime = -2
ownpal = 1
sprpriority = 2

[State 192, 2]
type = PlaySnd
trigger1 = time = 0
value = s0,18

[State 50, 1]
type = VarSet
trigger1 = Time = 0
var(4) = 1

[State 50, 2]
type = ChangeState
trigger1 = Time = 0 
value = 70000
ctrl = 1

;-----------------------------
; Jump Start
[Statedef 70000]
type    = S
physics = S
anim = 40
ctrl = 0
sprpriority = 1

[State 40, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

;[State 40, 2]
;type = VarSet
;trigger1 = command = "holdfwd"
;sysvar(1) = 1
;
;[State 40, 3]
;type = VarSet
;trigger1 = command = "holdback"
;sysvar(1) = -1

[State 40, 4]
type = VelSet
trigger1 = AnimTime = 0
x = 4;ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
y = ifelse(prevstateno = 2600,-15.5,const(velocity.jump.y))

[State 50, 1]
type = VarSet
trigger1 = AnimTime = 0 && prevstateno = 2600
var(4) = 1

[State 40, 5]
type = VelSet
trigger1 = AnimTime = 0
trigger1 = prevstateno = 100 || Var(55) ;RUN_FWD
trigger1 = sysvar(1) = 1
x = const(velocity.runjump.fwd.x)

[State 40, Super Jump Up Sparks]
type = Explod
anim = 8035
ID = 8035
trigger1 = time = 0
trigger1 = var(3) = 1
trigger1 = anim = 50
postype = P1
pos = -2,-8
ownpal = 1
bindtime = -1
removeongethit = 1
sprpriority = 5

[State 40, Super Jump Up Sparks]
type = Explod
anim = 8036
ID = 8036
trigger1 = time = 0
trigger1 = var(3) = 1
trigger1 = anim = 51
postype = P1
pos = -2,-8
ownpal = 1
bindtime = -1
removeongethit = 1
sprpriority = 5

[State 40, Super Jump Up Sparks]
type = Explod
anim = 8037
ID = 8037
trigger1 = time = 2
trigger1 = var(3) = 1
trigger1 = anim = 52
postype = P1
pos = -2,-8
ownpal = 1
bindtime = -1
removeongethit = 1
sprpriority = 5


[State 111, 3] ;Super Jump Dust
type = Explod
trigger1 = Time = [0, 20]
trigger1 = Vel Y < 0
trigger1 = Time % 3 = 2
anim = 9185
pos = 0,0
sprpriority = 7
ownpal = 1
random = 20, 20
scale = 0.5,0.5

[State 40, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 70001
ctrl = 1
;-----------------------------------------------------
; Jump Up
[Statedef 70001]
type    = A
physics = A

[State 40, Super Jump Up Sparks]
type = Explod
anim = 8035
ID = 8035
trigger1 = time = 2
trigger1 = var(4) = 1
trigger1 = anim = 41
postype = P1
pos = -2,-8
ownpal = 1
bindtime = -1
removeongethit = 1
sprpriority = 5

[State 40, Super Jump Up Sparks]
type = Explod
anim = 8036
ID = 8036
trigger1 = time = 2
trigger1 = var(4) = 1
trigger1 = anim = 42
postype = P1
pos = -20,-8
ownpal = 1
bindtime = -1
removeongethit = 1
sprpriority = 5

[State 40, Super Jump Up Sparks]
type = Explod
anim = 8037
ID = 8037
trigger1 = time = 2
trigger1 = var(4) = 1
trigger1 = anim = 43
postype = P1
pos = 15,-8
ownpal = 1
bindtime = -1
removeongethit = 1
sprpriority = 5

[State 0, 1]
type = PlayerPush
trigger1 = enemynear, statetype !=A
value = 0
;ignorehitpause = 0
;persistent = 1

[State 50, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 50, 2]
type = ChangeAnim
trigger1 = Time = 0
value = ifelse((vel x)=0, 41, ifelse((vel x)>0, 42, 43))

[State 50, 3]
type = ChangeAnim
trigger1 = Vel y > -2
trigger1 = SelfAnimExist(anim + 3)
persistent = 0
value = Anim + 3

[State 0, 1]
type = VelAdd
triggerall = (Var(4) = 1) && (Vel X <= const(velocity.jump.fwd.x)) && (Time >= 10)
trigger1 = Command = "holdfwd"
x = 0.15

[State 0, 2]
type = VelAdd
triggerall = (Var(4) = 1) && (Vel X >= const(velocity.jump.back.x)) && (Time >= 10)
trigger1 = Command = "holdback"
x = -0.15

[State 0, 3] 
type = VelAdd
trigger1 = (Var(4) = 1)
y = -0.1

[State 0, 4]
type = Turn
trigger1 = (Var(4) = 1) && (P2Dist X < -5)


